extends layout

block content
  script.
    $(document).ready(function () {
      $('#feed-content style').remove()
      $("table").addClass("table")
    });
  if data
    .row
      .col-md-3
        p.lead(style="padding-top:1em")
          img(src="https://upload.wikimedia.org/wikipedia/commons/d/d3/Parentesi_Graffe.svg" style="vertical-align:middle; margin-right:0.3em; height:1.2em;")
          span(style="vertical-align:middle;")
            a(href="/")
              b JSON Feed Viewer
      .col-md-9
        span Load another feed...
        form.form(method="get" action="/feed")
          .input-group
            input.form-control(type='text', name="url", placeholder='Feed URL')
            span.input-group-btn
              button.btn.btn-success(type='submit') Go
    +flash-messages(messages)
    hr
    .row
      .col-sm-3
        .small: b CURRENT FEED
        br
        a(href=data.home_page_url)
          if data.icon
            img(style="margin-bottom:20px; max-width:50px;" src=data.icon)
          else if data.favicon
            img(style="margin-bottom:20px; max-width:50px;" src=data.favicon)
          else
            img(style="margin-bottom:20px; max-width:100px;" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ac/No_image_available.svg/1024px-No_image_available.svg.png")
            
        p
          a(href=data.home_page_url)
            b=data.title
        p= data.description
        if data.author && data.author.name
          p
            em
              | A feed by 
              = data.author.name
        p.label.label-default= feedType.toUpperCase()
        hr
      .col-sm-9
        if data.items
          for i in data.items
            if i.external_url
              a(target="_blank" href=i.external_url)
                h1(style="margin-top:0;")= i.title
            else
              h1(style="margin-top:0;")= i.title
            p
              if i.url
                a(target="_blank" href=i.url)
                  | Permalink
                  i(style="margin-left:0.4em;" class="fa fa-external-link" aria-hidden="true")
              if i.date_published
                - var datePublished = moment(i.date_published)
              if i.date_modified
                - var dateModified = moment(i.date_modified)

              if datePublished
                |  - Posted on 
                = datePublished.format("YYYY-MM-DD HH:mm")
                if dateModified && !dateModified.isSame(datePublished, "minute")
                  span
                    | , modified 
                    if datePublished.isSame(dateModified, 'day')
                      | at 
                      = dateModified.format("HH:mm")
                    else
                      | on 
                      = dateModified.format("YYYY-MM-DD HH:mm")

            if i.image
              img(src=i.image style="margin:2em 0; max-height:25em")
            else if i.banner_image
              img(src=i.banner_image style="margin:2em 0; max-height:25em")

            #feed-content
              if i.content_html
                p!= i.content_html
              else if i.content_text
                p!= i.content_text
            hr