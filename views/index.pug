extends layout

block content
  if data
    .row
      .col-md-3
        p.lead(style="padding-top:1em")
          img(src="https://upload.wikimedia.org/wikipedia/commons/d/d3/Parentesi_Graffe.svg" style="vertical-align:middle; margin-right:0.3em; height:1.2em;")
          span(style="vertical-align:middle;")
            a(href="/")
              b JSON Feed Viewer
      .col-md-9
        span Load another JSON feed...
        form.form-inline(method="get")
          .input-group
            input.form-control(type='text', name="feed_url", placeholder='Feed URL')
            span.input-group-btn
              button.btn.btn-success(type='submit') Go
    hr
    .row
      .col-sm-3
        .small: b CURRENT FEED
        br
        a(href=data.home_page_url)
          if data.icon
            img(style="margin-bottom:20px; max-width:50px;" src=data.icon)
          else if data.favicon
            img(style="margin-bottom:20px; max-width:50px;" src=data.favicon)
          else
            img(style="margin-bottom:20px; max-width:100px;" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ac/No_image_available.svg/1024px-No_image_available.svg.png")
            
        p
          a(href=data.home_page_url)
            b=data.title
        p= data.description
        if data.author && data.author.name
          p
            em
              | A feed by 
              = data.author.name
        hr
      .col-sm-9
        if data.items
          for i in data.items
            if i.external_url
              a(target="_blank" href=i.external_url)
                h1(style="margin-top:0;")= i.title
            else
              h1(style="margin-top:0;")= i.title
            p
              if i.date_published
                - var datePublished = moment(i.date_published)
              if i.date_modified
                - var dateModified = moment(i.date_modified)

              | Posted on 
              = datePublished.format("YYYY-MM-DD HH:mm")
              if dateModified && !dateModified.isSame(datePublished, "minute")
                span
                  | , modified 
                  if datePublished.isSame(dateModified, 'day')
                    | at 
                    = dateModified.format("HH:mm")
                  else
                    | on 
                    = dateModified.format("YYYY-MM-DD HH:mm")

            p!= i.content_html
            hr
  else
    h1 Welcome to JSON Feed Viewer!
    p.lead Browse through the showcased JSON feeds below, or type in a JSON feed URL above.
    div
      form(method="get")
        .input-group
          input.form-control(type='text', name="feed_url", placeholder='Feed URL')
          span.input-group-btn
            button.btn.btn-success(type='submit') Go
    hr
    if showcaseFeeds
      .row
        for showcaseFeed in showcaseFeeds
          .col-sm-6.col-md-4.col-lg-3
            div.panel.panel-default
              .panel-body
                a(href="/?feed_url="+encodeURIComponent(showcaseFeed.feed_url))
                  img(style="max-width:50px;" src=(showcaseFeed.icon ? showcaseFeed.icon : showcaseFeed.favicon))
                h3
                  a(href="/?feed_url="+encodeURIComponent(showcaseFeed.feed_url))
                    b=showcaseFeed.title
                p= showcaseFeed.description
                if showcaseFeed.author && showcaseFeed.author.name
                  p
                    em
                      | A feed by 
                      = showcaseFeed.author.name
                a(href="/?feed_url="+encodeURIComponent(showcaseFeed.feed_url))
                  .btn.btn-success.btn-sm Read feed